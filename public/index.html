
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI Website Builder</title>
  <style>
    body { display: flex; font-family: sans-serif; margin: 0; height: 100vh; }
    #left { width: 50%; padding: 20px; overflow-y: auto; background: #f0f0f0; }
    #right { width: 50%; border-left: 2px solid #ccc; }
    textarea { width: 100%; padding: 10px; font-size: 16px; }
    button { margin-top: 10px; padding: 10px; font-size: 16px; width: 100%; }
    #log { margin-top: 20px; background: white; padding: 10px; height: 70vh; overflow-y: scroll; border-radius: 8px; }
  </style>
</head>
<body>
  <div id="left">
    <h2>ðŸ§  AI Website Builder</h2>
    <textarea id="prompt" rows="4" placeholder="Describe your website..."></textarea>
    <button onclick="start()">Generate Website</button>
    <div id="log"></div>
  </div>
  <div id="right">
    <iframe id="preview" src="/preview/index.html" width="100%" height="100%"></iframe>
  </div>

  <script>
    const logDiv = document.getElementById("log");

    const ws = new WebSocket(`ws://${location.host}`);
    ws.onmessage = (e) => {
      logDiv.innerText += e.data + "\n";
      logDiv.scrollTop = logDiv.scrollHeight;
      // Reload iframe when file written
      if (e.data.includes("index.html")) {
        document.getElementById("preview").src = "/preview/index.html?" + Date.now();
      }
    };

    function start() {
      const prompt = document.getElementById("prompt").value;
      logDiv.innerText = "Generating...\n";
      fetch(`/start?q=${encodeURIComponent(prompt)}`);
    }
  </script>
</body>
</html>
